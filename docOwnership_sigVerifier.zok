
import "hashes/sha256/shaRound" as shaRound;
import "utils/pack/u32/pack128" as pack128;
import "./keypairVerifierEddsa.zok" as keypairVerifierEddsa;
import "./sha256bitInput.zok" as sha256;



// def main(private u32[12][16] preImage, private field mechanicSignature, field pubIPFS_CID_A, field pubIPFS_CID_B) -> field {   // 32*12*16 bits = 6.144 bits -> 768 bytes
def main(private u8[800] preImage, private field mechanicSignature, u32[8] IPFS_CID) -> field {   // 800*8 bits = 6400 bits -> 800 bytes
   
    // hash the document
    u32[8] docHash = sha256(preImage); 

    // compare whether document hash equals corresponding IPFS-CID
    assert(IPFS_CID[0] == docHash[0]);
    assert(IPFS_CID[1] == docHash[1]);
    assert(IPFS_CID[2] == docHash[2]);
    assert(IPFS_CID[3] == docHash[3]);
    assert(IPFS_CID[4] == docHash[4]);
    assert(IPFS_CID[5] == docHash[5]);
    assert(IPFS_CID[6] == docHash[6]);
    assert(IPFS_CID[7] == docHash[7]);

    // verify mechanic signature
    field signatureVerified = keypairVerifierEddsa(mechanicSignature);

    return signatureVerified;

}


/*

preImage=5, 8*800 bits input
zokrates compute-witness -a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 123456789 1752934836 1514644219 1769680125 4157050362 66883612 1034777862 2107048462 3727103767 

sha256ByteInput.zok Output:
        ~out_7 3727103767
        ~out_6 2107048462
        ~out_5 1034777862
        ~out_4 66883612
        ~out_3 4157050362
        ~out_2 1769680125
        ~out_1 1514644219
        ~out_0 1752934836

 1752934836, 1514644219,
  1769680125, 4157050362,
    66883612, 1034777862,
  2107048462, 3727103767
===============================================

preImage=EASAForm1, 8*800 bits input
zokrates compute-witness -a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 123 34 97 112 112 114 111 118 105 110 103 67 105 118 105 108 65 118 105 97 116 105 111 110 65 117 116 104 111 114 105 116 121 34 58 34 70 65 65 32 47 32 85 110 105 116 101 100 32 83 116 97 116 101 115 34 44 34 102 111 114 109 84 121 112 101 34 58 34 70 65 65 32 70 79 82 77 32 56 49 51 48 45 51 34 44 34 102 111 114 109 84 114 97 99 107 105 110 103 78 117 109 98 101 114 34 58 34 57 53 52 57 45 50 34 44 34 111 119 110 101 114 78 97 109 101 34 58 34 72 97 109 105 108 116 111 110 32 83 117 110 100 115 116 114 97 110 100 32 65 118 105 97 116 105 111 110 32 83 101 114 118 105 99 101 115 44 32 73 110 99 46 34 44 34 111 119 110 101 114 65 100 100 114 101 115 115 34 58 34 51 54 48 49 32 70 108 97 109 105 110 103 111 32 82 111 97 100 34 44 34 119 111 114 107 79 114 100 101 114 34 58 34 52 49 48 56 55 54 49 53 34 44 34 105 116 101 109 79 102 87 111 114 107 79 114 100 101 114 34 58 50 44 34 112 97 114 116 68 101 115 99 114 105 112 116 105 111 110 34 58 34 71 69 78 69 82 65 84 79 82 32 79 85 84 76 73 78 69 44 32 50 53 48 32 75 86 65 32 86 70 34 44 34 112 97 114 116 78 117 109 98 101 114 34 58 34 55 48 48 49 51 51 48 72 48 51 34 44 34 113 117 97 110 116 105 116 121 34 58 53 44 34 115 101 114 105 97 108 78 117 109 98 101 114 34 58 34 51 52 53 53 51 51 51 51 53 34 44 34 115 116 97 116 117 115 34 58 34 114 101 112 97 105 114 101 100 34 44 34 114 101 109 97 114 107 115 34 58 34 80 47 78 32 67 72 65 78 71 69 68 32 84 79 32 55 48 48 49 51 51 48 72 48 52 46 34 44 34 97 112 112 114 111 118 101 100 68 101 115 105 103 110 34 58 116 114 117 101 44 34 115 104 111 112 82 101 115 112 111 110 115 105 98 108 101 83 105 103 110 97 116 117 114 101 34 58 34 100 47 98 47 97 32 72 97 109 105 108 116 111 110 32 83 117 110 100 115 116 114 97 110 100 32 87 111 114 108 100 119 105 100 101 34 44 34 115 104 111 112 67 101 114 116 105 102 105 99 97 116 101 78 111 34 58 34 75 65 52 82 51 48 51 77 34 44 34 115 104 111 112 101 78 97 109 101 34 58 34 72 97 109 105 108 116 111 110 32 83 117 110 100 115 116 114 97 110 100 34 44 34 114 101 116 117 114 110 84 111 83 101 114 118 105 99 101 34 58 102 97 108 115 101 44 34 111 116 104 101 114 82 101 103 117 108 97 116 105 111 110 115 65 112 112 108 121 34 58 116 114 117 101 44 34 109 101 99 104 97 110 105 99 83 105 103 110 97 116 117 114 101 34 58 34 77 105 99 104 97 101 108 32 83 99 104 117 108 122 34 44 34 109 101 99 104 97 110 105 115 67 101 114 116 105 102 105 99 97 116 101 78 111 34 58 34 75 65 52 82 51 48 51 77 34 44 34 100 97 116 101 111 102 73 115 115 117 101 34 58 34 50 48 50 49 45 48 52 45 50 51 34 125 123456789 721721968 3351953154 4075627345 4035618894 3676689697 3862779541 899312527 2124064162


sha256padded.js output: 
   [721721968, 3351953154,
  4075627345, 4035618894,
  3676689697, 3862779541,
   899312527, 2124064162]

*/
