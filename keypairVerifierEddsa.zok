import "ecc/edwardsAdd" as add;
import "ecc/edwardsScalarMult" as multiply;
import "utils/pack/bool/nonStrictUnpack256" as unpack256;
from "ecc/babyjubjubParams" import BabyJubJubParams;
import "ecc/babyjubjubParams.code" as context;


// list with 10 different public keys. Public keys are field[2] elements
const field[10][2] pubKeyList = [            
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080374],  // corresponds to privKey = 123456789
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080370],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080371],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080372],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080373],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    187790246631372605794846029045227521568274135475147271248704584614696508037],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080375],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080376],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080377],
    [5406141598975088696144699008760408187583441857012693422636262514979414131332, 
    1877902466313726057948460290452275215682741354751472712487045846146965080378]
  ];



def main(private field privKey) -> field {

    BabyJubJubParams context = context();
    field[2] G = [context.Gu, context.Gv];

    bool[256] skBits = unpack256(privKey);  // binary encoding of private Key with a length of 256 bits
    field[2] pubKey = multiply(skBits, G, context);  // calculate public Key from private Key

    field mut result = 0;

    // iterate through public key list
    for u32 i in 0..10 {
        // check whether public key is included in list 
        result = if pubKey[0] == pubKeyList[i][0] && pubKey[1] == pubKeyList[i][1] {1} else {result};
    }  
    
    return result;
}

// 5406141598975088696144699008760408187583441857012693422636262514979414131332 1877902466313726057948460290452275215682741354751472712487045846146965080374